<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>population-growth-with-spip • CKMRpop</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="population-growth-with-spip">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CKMRpop</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.3.9999</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/about_spip.html">About spip</a>
    </li>
    <li>
      <a href="../articles/population-growth-with-spip.html">population-growth-with-spip</a>
    </li>
    <li>
      <a href="../articles/simple-example-with-migration.html">A Simple Example With Migration</a>
    </li>
    <li>
      <a href="../articles/species_1_simulation.html">Simulation from species 1 life history</a>
    </li>
    <li>
      <a href="../articles/using-other-simulation-programs.html">Using Other Simulation Programs with CKMRpop</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>population-growth-with-spip</h1>
            
      

      <div class="hidden name"><code>population-growth-with-spip.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">CKMRpop</span><span class="op">)</span></span></code></pre></div>
<p>The default simulation engine for CKMRpop, <code>spip</code>, is not
well suited to scenarios with population growth or other size changes.
This is because the survival rates cannot be set to vary over time. So
the only way that population growth or decline occurs is by manipulating
the number of individuals entering the population each year.</p>
<p>This is done with the <code>--cohort-size</code> parameter.
Specifically, if you are doing a simulation for T years, you can do like
this:</p>
<pre><code>--cohort-size var J1 J2...JT</code></pre>
<p>where J1 … JT are T integers giving the number of individuals
entering the population each year. As the spip documentation says:</p>
<pre><code>        this makes the expected cohort size each year from
        MaxAge to T+MaxAge-1 equal to J1 J2...JT respectively. Hence there
        must be T such arguments J following the var option (where T is the
        number of years that the simulation will run---the argument to the -T
        or the --number-of-years option.)</code></pre>
<p>The CKMRpop function <code><a href="../reference/leslie_from_spip.html">leslie_from_spip()</a></code> provides a way
to figure out what the initial number of individuals should be, and what
the cohort sizes should be each year to simulate a growing or shrinking
population that has reached an equilibrium stable age distribution. (I
suspect that few populations of interest actually reach this type of
equilibrium—certainly not fish populations with high recruitment
variability—but for some purposes it will be important to be able to
simulate such a population.)</p>
<p>Note that this is only implemented correctly for scenarios in which
male and female age-specific survival rates are the same.</p>
<p>Here we demonstrate how to simulate with population growth and
decline in that equilibrium context.</p>
<p>Starting with a cohort size of 300 at just before the initial time
step, we show how to create a 1% rate of increase in the
species_1_life_history population for 100 years, and we also show a
scenario with a 0.05% rate of decline for 100 years. We can calculate
the parameters for both from a single call to
<code><a href="../reference/leslie_from_spip.html">leslie_from_spip()</a></code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">CKMRpop</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/leslie_from_spip.html">leslie_from_spip</a></span><span class="op">(</span></span>
<span>  P <span class="op">=</span> <span class="va">species_1_life_history</span>, </span>
<span>  C <span class="op">=</span> <span class="fl">300</span>, </span>
<span>  growth_rates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="op">-</span><span class="fl">0.005</span><span class="op">)</span>, </span>
<span>  T <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>That object <code>pars</code> has the parameters we need to simulate
the population under those scenarios. For the scenarios with specified
growth rates, the results we need are in:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>pars<span class="sc">$</span>growth_rate_results<span class="sc">$</span>[[<span class="st">"0.01"</span>]]</span></code></pre></div>
<p>and</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>pars<span class="sc">$</span>growth_rate_results<span class="sc">$</span>[[<span class="st">"-0.005"</span>]]</span></code></pre></div>
<p>respectively.</p>
<div class="section level2">
<h2 id="population-growth-of-0-01">Population growth of 0.01<a class="anchor" aria-label="anchor" href="#population-growth-of-0-01"></a>
</h2>
<p>We just have to set up the iniital pop sizes and cohort sizes.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">GrowthPars</span> <span class="op">&lt;-</span> <span class="va">species_1_life_history</span></span>
<span></span>
<span><span class="co"># always put the number of years in first:</span></span>
<span><span class="va">GrowthPars</span><span class="op">$</span><span class="va">`number-of-years`</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span></span>
<span></span>
<span><span class="va">GrowthPars</span><span class="op">$</span><span class="va">`initial-females`</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="va">pars</span><span class="op">$</span><span class="va">growth_rate_results</span><span class="op">$</span><span class="va">`0.01`</span><span class="op">$</span><span class="va">stable_age_distro_fem</span><span class="op">)</span></span>
<span><span class="va">GrowthPars</span><span class="op">$</span><span class="va">`initial-males`</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="va">pars</span><span class="op">$</span><span class="va">growth_rate_results</span><span class="op">$</span><span class="va">`0.01`</span><span class="op">$</span><span class="va">stable_age_distro_male</span><span class="op">)</span></span>
<span><span class="va">GrowthPars</span><span class="op">$</span><span class="va">`cohort-size`</span> <span class="op">&lt;-</span> <span class="va">pars</span><span class="op">$</span><span class="va">growth_rate_results</span><span class="op">$</span><span class="va">`0.01`</span><span class="op">$</span><span class="va">cohort_size_param_string</span></span>
<span></span>
<span></span>
<span><span class="co"># we also add some sampling parameters here</span></span>
<span><span class="va">samp_frac</span> <span class="op">&lt;-</span> <span class="fl">0.03</span></span>
<span><span class="va">samp_start_year</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">samp_stop_year</span> <span class="op">&lt;-</span> <span class="fl">75</span></span>
<span><span class="va">GrowthPars</span><span class="op">$</span><span class="va">`discard-all`</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">GrowthPars</span><span class="op">$</span><span class="va">`gtyp-ppn-fem-post`</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span></span>
<span>  <span class="va">samp_start_year</span>, <span class="st">"-"</span>, <span class="va">samp_stop_year</span>, <span class="st">" "</span>, </span>
<span>  <span class="va">samp_frac</span>, <span class="st">" "</span>, <span class="va">samp_frac</span>, <span class="st">" "</span>, <span class="va">samp_frac</span>, <span class="st">" "</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">GrowthPars</span><span class="op">$</span><span class="va">`max-age`</span> <span class="op">-</span> <span class="fl">3</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">" "</span><span class="op">)</span>,</span>
<span>  sep <span class="op">=</span> <span class="st">""</span></span>
<span><span class="op">)</span></span>
<span><span class="va">GrowthPars</span><span class="op">$</span><span class="va">`gtyp-ppn-male-post`</span> <span class="op">&lt;-</span> <span class="va">GrowthPars</span><span class="op">$</span><span class="va">`gtyp-ppn-fem-post`</span></span></code></pre></div>
<p>Then we can run the population:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>  <span class="co"># set a seed for reproducibility of results</span></span>
<span><span class="va">spip_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_spip.html">run_spip</a></span><span class="op">(</span>pars <span class="op">=</span> <span class="va">GrowthPars</span><span class="op">)</span>  <span class="co"># run spip</span></span>
<span><span class="va">slurped</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/slurp_spip.html">slurp_spip</a></span><span class="op">(</span><span class="va">spip_dir</span>, <span class="fl">2</span><span class="op">)</span> <span class="co"># read the spip output into R</span></span></code></pre></div>
<p>Now, let’s plot the population sizes to see it is doing what we
expect it to be doing:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggplot_census_by_year_age_sex.html">ggplot_census_by_year_age_sex</a></span><span class="op">(</span><span class="va">slurped</span><span class="op">$</span><span class="va">census_postkill</span><span class="op">)</span></span></code></pre></div>
<p><img src="population-growth-with-spip_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
<p>OK, that looks pretty much like it ought to.</p>
</div>
<div class="section level2">
<h2 id="population-decline-of-0-005">Population decline of 0.005<a class="anchor" aria-label="anchor" href="#population-decline-of-0-005"></a>
</h2>
<p>We just have to set up the iniital pop sizes and cohort sizes.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">DeclinePars</span> <span class="op">&lt;-</span> <span class="va">species_1_life_history</span></span>
<span></span>
<span><span class="co"># always put the number of years in first:</span></span>
<span><span class="va">DeclinePars</span><span class="op">$</span><span class="va">`number-of-years`</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span></span>
<span></span>
<span><span class="va">DeclinePars</span><span class="op">$</span><span class="va">`initial-females`</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="va">pars</span><span class="op">$</span><span class="va">growth_rate_results</span><span class="op">$</span><span class="va">`-0.005`</span><span class="op">$</span><span class="va">stable_age_distro_fem</span><span class="op">)</span></span>
<span><span class="va">DeclinePars</span><span class="op">$</span><span class="va">`initial-males`</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="va">pars</span><span class="op">$</span><span class="va">growth_rate_results</span><span class="op">$</span><span class="va">`-0.005`</span><span class="op">$</span><span class="va">stable_age_distro_male</span><span class="op">)</span></span>
<span><span class="va">DeclinePars</span><span class="op">$</span><span class="va">`cohort-size`</span> <span class="op">&lt;-</span> <span class="va">pars</span><span class="op">$</span><span class="va">growth_rate_results</span><span class="op">$</span><span class="va">`-0.005`</span><span class="op">$</span><span class="va">cohort_size_param_string</span></span>
<span></span>
<span></span>
<span><span class="co"># we also add some sampling parameters here</span></span>
<span><span class="va">samp_frac</span> <span class="op">&lt;-</span> <span class="fl">0.03</span></span>
<span><span class="va">samp_start_year</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">samp_stop_year</span> <span class="op">&lt;-</span> <span class="fl">75</span></span>
<span><span class="va">DeclinePars</span><span class="op">$</span><span class="va">`discard-all`</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">DeclinePars</span><span class="op">$</span><span class="va">`gtyp-ppn-fem-post`</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span></span>
<span>  <span class="va">samp_start_year</span>, <span class="st">"-"</span>, <span class="va">samp_stop_year</span>, <span class="st">" "</span>, </span>
<span>  <span class="va">samp_frac</span>, <span class="st">" "</span>, <span class="va">samp_frac</span>, <span class="st">" "</span>, <span class="va">samp_frac</span>, <span class="st">" "</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">DeclinePars</span><span class="op">$</span><span class="va">`max-age`</span> <span class="op">-</span> <span class="fl">3</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">" "</span><span class="op">)</span>,</span>
<span>  sep <span class="op">=</span> <span class="st">""</span></span>
<span><span class="op">)</span></span>
<span><span class="va">DeclinePars</span><span class="op">$</span><span class="va">`gtyp-ppn-male-post`</span> <span class="op">&lt;-</span> <span class="va">DeclinePars</span><span class="op">$</span><span class="va">`gtyp-ppn-fem-post`</span></span></code></pre></div>
<p>Then we can run the population:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>  <span class="co"># set a seed for reproducibility of results</span></span>
<span><span class="va">spip_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_spip.html">run_spip</a></span><span class="op">(</span>pars <span class="op">=</span> <span class="va">DeclinePars</span><span class="op">)</span>  <span class="co"># run spip</span></span>
<span><span class="va">slurped</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/slurp_spip.html">slurp_spip</a></span><span class="op">(</span><span class="va">spip_dir</span>, <span class="fl">2</span><span class="op">)</span> <span class="co"># read the spip output into R</span></span></code></pre></div>
<p>Now, let’s plot the population sizes to see it is doing what we
expect it to be doing:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggplot_census_by_year_age_sex.html">ggplot_census_by_year_age_sex</a></span><span class="op">(</span><span class="va">slurped</span><span class="op">$</span><span class="va">census_postkill</span><span class="op">)</span></span></code></pre></div>
<p><img src="population-growth-with-spip_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Eric C. Anderson.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
